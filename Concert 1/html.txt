<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VibeTickets ‚Äî Concert Tickets Marketplace</title>
  <style>
    /* Basic reset */
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#ff6b6b; --muted:#94a3b8; --glass:rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; background:linear-gradient(180deg,#071021 0%, #07192b 60%); color:#e6eef8}
    a{color:inherit}
    .wrap{max-width:1100px; margin:28px auto; padding:20px}

    header{display:flex; align-items:center; gap:18px}
    .logo{display:flex; align-items:center; gap:10px}
    .logo .mark{width:46px; height:46px; border-radius:10px; background:linear-gradient(135deg,var(--accent),#ffb86b); display:flex; align-items:center; justify-content:center; font-weight:800; color:#051017}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted); font-size:13px}

    .layout{display:grid; grid-template-columns: 1fr 360px; gap:20px; margin-top:18px}

    /* Main list */
    .controls{display:flex; gap:10px; margin-bottom:12px; align-items:center}
    .search{flex:1}
    input,select,button{padding:10px 12px; border-radius:10px; border:0; background:var(--glass-2); color:inherit}
    .filters{display:flex; gap:8px}

    .list{display:grid; gap:12px}
    .ticket{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; display:flex; overflow:hidden; box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    .ticket img{width:260px; height:160px; object-fit:cover}
    .ticket .meta{padding:14px; display:flex; flex-direction:column; gap:8px}
    .title{font-weight:700; font-size:16px}
    .meta .row{display:flex; gap:10px; align-items:center; font-size:13px; color:var(--muted)}
    .price{margin-left:auto; font-weight:800; color:var(--accent)}
    .badge{background:rgba(255,255,255,0.04); padding:6px 8px; border-radius:8px; font-size:12px}

    /* Sidebar */
    .sidebar{position:sticky; top:28px; background:var(--card); padding:14px; border-radius:12px}
    .cart{display:flex; flex-direction:column; gap:8px}
    .cart-item{display:flex; gap:10px; align-items:center}
    .small{width:56px; height:40px; object-fit:cover; border-radius:6px}
    .muted{color:var(--muted)}

    /* Map and details */
    .map{width:100%; height:200px; border-radius:10px; overflow:hidden}

    /* Social feed */
    .feed{margin-top:14px; display:flex; flex-direction:column; gap:10px}
    .post{background:var(--glass); padding:10px; border-radius:10px}
    .post h4{margin:0 0 6px 0}
    .cta{display:flex; gap:10px; margin-top:10px}

    /* Modal */
    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(1,4,9,0.6); z-index:40}
    .modal .sheet{background:#061223; padding:18px; width:420px; border-radius:12px}

    footer{margin:28px 0; color:var(--muted); font-size:13px; text-align:center}

    @media (max-width:920px){.layout{grid-template-columns:1fr} .ticket img{width:150px} .sidebar{position:static} }

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <div class="mark">V</div>
        <div>
          <h1>VibeTickets</h1>
          <p class="lead">Buy, share and feel the moment ‚Äî secure your spot at live concerts</p>
        </div>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center">
        <button id="open-cart">üõí Cart <span id="cart-count" style="background:var(--accent); color:#051017; padding:4px 8px; border-radius:8px; margin-left:8px; font-weight:700">0</span></button>
        <button id="signin">Sign in</button>
      </div>
    </header>

    <div class="layout">
      <main>
        <div class="controls">
          <input id="q" class="search" placeholder="Search artists, venues..." />
          <div class="filters">
            <select id="genre"><option value="all">All genres</option><option>Pop</option><option>Rock</option><option>Afrobeat</option><option>EDM</option></select>
            <select id="sort"><option value="popular">Most popular</option><option value="price-asc">Price: low‚Üíhigh</option><option value="price-desc">Price: high‚Üílow</option></select>
          </div>
        </div>

        <div class="list" id="tickets-list">
          <!-- JS will populate tickets here -->
        </div>

        <section style="margin-top:18px">
          <h3 style="margin:0 0 10px 0">Nearby Venue (Map)</h3>
          <div class="map">
            <!-- Google Maps embed (public embed). Change the q param to center the map on a venue. -->
            <iframe id="gmap" width="100%" height="100%" frameborder="0" style="border:0" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps/embed/v1/place?key=YOUR_GOOGLE_MAPS_EMBED_API_KEY&q=KICC,Nairobi,Kenya" allowfullscreen></iframe>
          </div>
        </section>

        <section class="feed">
          <h3 style="margin:0">Social feed</h3>
          <div class="post">
            <h4>‚ú® Live: Afrobeat Night ‚Äî sold out in 2 days!</h4>
            <p class="muted">People are hyped ‚Äî share your pics and tag the artist. #VibeTickets</p>
            <div class="cta">
              <button class="like">üëç 142</button>
              <button class="comment">üí¨ Comment</button>
              <button class="share">üîó Share</button>
            </div>
          </div>
          <div class="post">
            <h4>üéü Promo: Use code <span style="color:var(--accent); font-weight:700">VIBE10</span> for 10% off selected shows</h4>
            <p class="muted">Valid until end of the month. Applies to card & digital payments.</p>
            <div class="cta"><button id="apply-code">Apply code</button></div>
          </div>
        </section>

      </main>

      <aside class="sidebar">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
          <h3 style="margin:0">Your cart</h3>
          <small class="muted">Secure checkout</small>
        </div>
        <div class="cart" id="cart"></div>
        <div style="margin-top:10px">
          <div style="display:flex; gap:8px; margin-bottom:8px">
            <button id="checkout">Checkout</button>
            <button id="clear-cart">Clear</button>
          </div>
          <div style="font-size:14px;color:var(--muted)">Total: <strong id="total">$0.00</strong></div>
        </div>

        <div style="margin-top:14px">
          <h4 style="margin:0 0 8px 0">Venue spotlight</h4>
          <div style="font-size:13px" class="muted">Kenyatta International Conference Centre<br/>Nairobi, Kenya<br/>Next major shows listed above</div>
        </div>
      </aside>
    </div>

    <footer>
      Built with ‚ù§ ‚Äî demo marketplace. Replace the Google Maps API key and payment endpoint to go live.
    </footer>
  </div>

  <!-- Modal for buying -->
  <div class="modal" id="modal">
    <div class="sheet">
      <h3 id="modal-title">Buy ticket</h3>
      <p class="muted" id="modal-sub">Select payment method</p>
      <div style="display:flex; gap:8px; margin-top:12px">
        <button class="pay" data-method="card">Pay with Card</button>
        <button class="pay" data-method="mpesa">M-PESA (Simulated)</button>
        <button class="pay" data-method="paypal">PayPal</button>
      </div>
      <div id="pay-form" style="margin-top:12px"></div>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px">
        <button id="cancel">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // Sample tickets data
    const tickets = [
      {id:1, artist:'Sauti Sol Live', genre:'Afrobeat', price:45.00, location:'KICC, Nairobi', time:'2025-12-12 19:00', img:'https://source.unsplash.com/800x500/?concert,band', popularity:98, qty:120},
      {id:2, artist:'Global EDM Fest', genre:'EDM', price:60.00, location:'Ngong Racecourse', time:'2025-12-20 22:00', img:'https://source.unsplash.com/800x500/?edm,party', popularity:145, qty:350},
      {id:3, artist:'The Rock Echoes', genre:'Rock', price:35.00, location:'Nairobi Arena', time:'2026-01-10 18:00', img:'https://source.unsplash.com/800x500/?rock,concert', popularity:76, qty:200},
      {id:4, artist:'Pop Queens Tour', genre:'Pop', price:50.00, location:'KICC, Nairobi', time:'2026-02-05 20:00', img:'https://source.unsplash.com/800x500/?pop,artist', popularity:120, qty:250},
    ];

    // In-memory cart
    let cart = [];

    // Utilities
    function $(sel){return document.querySelector(sel)}
    function formatMoney(n){return '$' + n.toFixed(2)}

    // Render tickets
    function renderList(){
      const container = $('#tickets-list'); container.innerHTML='';
      const q = $('#q').value.toLowerCase();
      const genre = $('#genre').value; const sort = $('#sort').value;
      let list = tickets.filter(t => (t.artist.toLowerCase().includes(q) || t.location.toLowerCase().includes(q)) && (genre==='all' || t.genre===genre));
      if(sort==='price-asc') list.sort((a,b)=>a.price-b.price);
      if(sort==='price-desc') list.sort((a,b)=>b.price-a.price);
      if(sort==='popular') list.sort((a,b)=>b.popularity-a.popularity);

      for(const t of list){
        const el = document.createElement('div'); el.className='ticket';
        el.innerHTML = `
          <img src="${t.img}" alt="${t.artist}" />
          <div class="meta">
            <div style="display:flex;align-items:center">
              <div class="title">${t.artist}</div>
              <div style="margin-left:auto" class="price">${formatMoney(t.price)}</div>
            </div>
            <div class="row"><div class="badge">${t.genre}</div><div class="muted">${t.location}</div><div class="muted">‚Ä¢ ${new Date(t.time).toLocaleString()}</div></div>
            <p class="muted" style="font-size:13px;margin:0">Tickets left: <strong>${t.qty}</strong></p>
            <div style="margin-top:auto; display:flex; gap:8px">
              <button class="buy" data-id="${t.id}">Buy</button>
              <button class="add" data-id="${t.id}">Add to cart</button>
              <button class="details" data-id="${t.id}">Details</button>
            </div>
          </div>
        `;
        container.appendChild(el);
      }

      // attach actions
      document.querySelectorAll('.add').forEach(btn=>btn.addEventListener('click', e=>{
        const id=+e.currentTarget.dataset.id; addToCart(id); updateUI();
      }));
      document.querySelectorAll('.buy').forEach(btn=>btn.addEventListener('click', e=>{
        const id=+e.currentTarget.dataset.id; openBuyModal(id);
      }));
      document.querySelectorAll('.details').forEach(btn=>btn.addEventListener('click', e=>{
        const id=+e.currentTarget.dataset.id; showDetails(id);
      }));
    }

    function addToCart(id){
      const item = tickets.find(t=>t.id===id);
      if(!item || item.qty<=0) return alert('Sold out');
      const existing = cart.find(c=>c.id===id);
      if(existing){ existing.qty++; } else { cart.push({id:item.id, artist:item.artist, price:item.price, qty:1, img:item.img}); }
      updateUI();
    }

    function updateUI(){
      const cartEl = $('#cart'); cartEl.innerHTML='';
      let total = 0; let count=0;
      cart.forEach(ci=>{
        total += ci.price * ci.qty; count += ci.qty;
        const div = document.createElement('div'); div.className='cart-item';
        div.innerHTML = <img src="${ci.img}" class="small"/><div style="flex:1"><div style="font-weight:700">${ci.artist}</div><div class="muted">${ci.qty} x ${formatMoney(ci.price)}</div></div><div style="display:flex;flex-direction:column;gap:6px"><button class='inc' data-id='${ci.id}'>+</button><button class='dec' data-id='${ci.id}'>-</button></div>;
        cartEl.appendChild(div);
      });
      $('#total').textContent = formatMoney(total);
      $('#cart-count').textContent = count;
      // attach inc/dec
      document.querySelectorAll('.inc').forEach(b=>b.addEventListener('click', e=>{ changeQty(+e.currentTarget.dataset.id, 1);}));
      document.querySelectorAll('.dec').forEach(b=>b.addEventListener('click', e=>{ changeQty(+e.currentTarget.dataset.id, -1);}));
    }

    function changeQty(id, delta){
      const ci = cart.find(c=>c.id===id); if(!ci) return;
      ci.qty += delta; if(ci.qty<=0) cart = cart.filter(c=>c.id!==id);
      updateUI();
    }

    function openBuyModal(id){
      const t = tickets.find(x=>x.id===id); if(!t) return;
      $('#modal-title').textContent = Buy ticket ‚Äî ${t.artist};
      $('#modal-sub').textContent = ${t.location} ‚Ä¢ ${new Date(t.time).toLocaleString()} ‚Ä¢ ${formatMoney(t.price)};
      $('#modal').style.display='flex';
      // store selected
      $('#modal').dataset.selected = id;
    }

    function showDetails(id){
      const t = tickets.find(x=>x.id===id); if(!t) return;
      alert(${t.artist}\nGenre: ${t.genre}\nLocation: ${t.location}\nTime: ${new Date(t.time).toLocaleString()}\nPrice: ${formatMoney(t.price)}\nTickets left: ${t.qty});
    }

    // Modal behaviour
    $('#cancel').addEventListener('click', ()=>{ $('#modal').style.display='none'; $('#pay-form').innerHTML=''; });
    document.querySelectorAll('.pay').forEach(b=> b.addEventListener('click', e=>{
      const method = e.currentTarget.dataset.method; renderPaymentForm(method);
    }));

    function renderPaymentForm(method){
      const sel = +$('#modal').dataset.selected; const t = tickets.find(x=>x.id===sel);
      const container = $('#pay-form'); container.innerHTML='';
      if(method==='card'){
        container.innerHTML = `
          <div style="display:flex;flex-direction:column;gap:8px">
            <input id="card-name" placeholder="Cardholder name" />
            <input id="card-number" placeholder="Card number (mock)" />
            <div style="display:flex;gap:8px"><input id="card-exp" placeholder="MM/YY"/><input id="card-cvc" placeholder="CVC"/></div>
            <button id="pay-now">Pay ${formatMoney(t.price)}</button>
          </div>
        `;
      } else if(method==='mpesa'){
        container.innerHTML = `
          <div style="display:flex;flex-direction:column;gap:8px">
            <input id="mpesa-number" placeholder="M-PESA number (e.g. 07XX...)" />
            <button id="pay-now">Simulate M-PESA Pay ${formatMoney(t.price)}</button>
            <small class="muted">This is a simulated flow for demo ‚Äî integrate Safaricom API to go live.</small>
          </div>
        `;
      } else if(method==='paypal'){
        container.innerHTML = `
          <div style="display:flex;flex-direction:column;gap:8px">
            <p class="muted">You will be redirected to a simulated PayPal page.</p>
            <button id="pay-now">Continue to PayPal (${formatMoney(t.price)})</button>
          </div>
        `;
      }

      $('#pay-now').addEventListener('click', ()=>{ processPayment(method); });
    }

    function processPayment(method){
      const sel = +$('#modal').dataset.selected; const t = tickets.find(x=>x.id===sel);
      // Basic validation
      if(!t || t.qty<=0){ alert('Ticket unavailable'); $('#modal').style.display='none'; return; }
      // Simulate decreasing inventory and creating order
      t.qty -= 1; // reserve 1 ticket
      cart = cart.filter(c=>c.id!==t.id); // remove from cart if present
      updateUI(); renderList();
      $('#modal').style.display='none';
      // Show success receipt
      setTimeout(()=>{
        alert('Payment successful ‚Äî your ticket is confirmed!\n\nArtist: '+t.artist+'\nWhen: '+new Date(t.time).toLocaleString()+'\nVenue: '+t.location+'\nPrice: '+formatMoney(t.price)+'\n\nA digital ticket has been added to your account (simulated).');
      },200);
    }

    // Checkout from sidebar
    $('#checkout').addEventListener('click', ()=>{
      if(cart.length===0) return alert('Cart is empty');
      // simple checkout: open modal for first item
      $('#modal').dataset.selected = cart[0].id; $('#modal').style.display='flex';
    });

    $('#clear-cart').addEventListener('click', ()=>{ cart=[]; updateUI(); });

    // Search and filters
    $('#q').addEventListener('input', renderList);
    $('#genre').addEventListener('change', renderList);
    $('#sort').addEventListener('change', renderList);

    // initial render
    renderList(); updateUI();

    // small enhancements: apply promo code
    $('#apply-code').addEventListener('click', ()=>{
      if($('#total').textContent === '$0.00') return alert('Add tickets to cart to apply the code.');
      // apply a 10% discount to the total
      const totText = $('#total').textContent.replace('$',''); const tot = parseFloat(totText);
      const discounted = (tot * 0.9).toFixed(2);
      $('#total').textContent = '$' + discounted;
      alert('Promo VIBE10 applied ‚Äî 10% off!');
    });

    // Fake sign in
    $('#signin').addEventListener('click', ()=>{ const name = prompt('Sign in (demo) ‚Äî enter your name'); if(name) alert('Welcome, '+name+' ‚Äî demo account active.'); });

    // open cart button
    $('#open-cart').addEventListener('click', ()=>{ window.scrollTo({top:0, behavior:'smooth'}); });

  </script>
</body>
</html>
